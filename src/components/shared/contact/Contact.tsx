"use client";

import { zodResolver } from "@hookform/resolvers/zod";
import Link from "next/link";
import { useForm } from "react-hook-form";
import { contactSchema, ContactType } from "./contactValidation";
import Input from "../Input";
import Textarea from "../Textarea";
import emailjs from "@emailjs/browser";
import { useRef, useState } from "react";
import { toast } from "react-toastify";

const Contact = () => {
  const [loading, setLoading] = useState(false);
  const formRef = useRef<HTMLFormElement>(null);
  const {
    register,
    handleSubmit,
    formState: { errors },
    reset,
  } = useForm<ContactType>({
    resolver: zodResolver(contactSchema),
    defaultValues: {
      name: "",
      email: "",
      phone: "",
      message: "",
    },
  });

  const handleContactSubmit = async (data: ContactType) => {
    if (!formRef.current) return;

    if (
      !process.env.NEXT_PUBLIC_EMAIL_SERVICE_ID ||
      !process.env.NEXT_PUBLIC_EMAIL_TEMPLATE_ID ||
      !process.env.NEXT_PUBLIC_EMAIL_PUBLIC_KEY
    ) {
      toast.error("Email configuration missing!");
      return;
    }
    setLoading(true);
    try {
      await emailjs.sendForm(
        process.env.NEXT_PUBLIC_EMAIL_SERVICE_ID,
        process.env.NEXT_PUBLIC_EMAIL_TEMPLATE_ID,
        formRef.current,
        { publicKey: process.env.NEXT_PUBLIC_EMAIL_PUBLIC_KEY }
      );

      toast.success("Message sent successfully!");

      reset();
    } catch (error) {
      console.log(error);
      toast.error("Failed to send message!");
    } finally {
      setLoading(false);
    }
  };

  return (
    <section className="container contact-wrapper" id="contact">
      <div className="heading">
        <h1 className="section-title">
          Contácta<span className="highlight">nos</span>
        </h1>
        <p className="section-subtitle">
          Estamos aquí para ayudarte. Envíanos un mensaje y responderemos lo
          antes posible.
        </p>
      </div>
      <div className="contact-content">
        <form
          ref={formRef}
          className="form"
          onSubmit={handleSubmit(handleContactSubmit)}
        >
          <Input
            type="text"
            label="Nombre"
            name="name"
            placeholder="Type Here..."
            error={errors.name?.message}
            register={register("name")}
          />
          <Input
            type="email"
            label="Correo electrónico"
            name="email"
            placeholder="Demo@gmail.com"
            error={errors.email?.message}
            register={register("email")}
          />
          <Input
            type="text"
            label="Teléfono"
            name="phone"
            placeholder="099 |"
            error={errors.phone?.message}
            register={register("phone")}
          />
          <Textarea
            label="Mensaje"
            name="message"
            placeholder="Type Here..."
            error={errors.message?.message}
            register={register("message")}
          />
          <button
            type="submit"
            disabled={loading}
            className="btn-primary send-btn"
            id="sendBtn"
          >
            {loading ? "Sending..." : "Enviar mensaje"}
            <span>
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M20.3402 9.31988L6.34025 2.31988C5.78774 2.04489 5.16386 1.94699 4.55368 2.03954C3.9435 2.13208 3.37671 2.41055 2.93058 2.837C2.48445 3.26345 2.1807 3.81711 2.06074 4.42249C1.94078 5.02788 2.01045 5.65554 2.26025 6.21988L4.66025 11.5899C4.7147 11.7197 4.74275 11.8591 4.74275 11.9999C4.74275 12.1407 4.7147 12.2801 4.66025 12.4099L2.26025 17.7799C2.05695 18.2366 1.971 18.7369 2.01022 19.2353C2.04945 19.7336 2.21259 20.2143 2.48483 20.6336C2.75707 21.0529 3.12977 21.3975 3.56907 21.6361C4.00837 21.8747 4.50033 21.9998 5.00025 21.9999C5.46848 21.9952 5.92974 21.8859 6.35025 21.6799L20.3502 14.6799C20.8468 14.4301 21.2643 14.0472 21.5559 13.574C21.8476 13.1007 22.0021 12.5558 22.0021 11.9999C22.0021 11.444 21.8476 10.899 21.5559 10.4258C21.2643 9.95258 20.8468 9.5697 20.3502 9.31988H20.3402ZM19.4502 12.8899L5.45025 19.8899C5.26641 19.9782 5.05998 20.0081 4.85863 19.9757C4.65729 19.9434 4.47066 19.8502 4.32376 19.7087C4.17686 19.5673 4.07673 19.3843 4.03678 19.1843C3.99683 18.9843 4.01897 18.7769 4.10025 18.5899L6.49025 13.2199C6.52119 13.1482 6.5479 13.0747 6.57025 12.9999H13.4602C13.7255 12.9999 13.9798 12.8945 14.1674 12.707C14.3549 12.5195 14.4602 12.2651 14.4602 11.9999C14.4602 11.7347 14.3549 11.4803 14.1674 11.2928C13.9798 11.1052 13.7255 10.9999 13.4602 10.9999H6.57025C6.5479 10.9251 6.52119 10.8516 6.49025 10.7799L4.10025 5.40988C4.01897 5.22285 3.99683 5.01543 4.03678 4.81545C4.07673 4.61547 4.17686 4.43249 4.32376 4.29103C4.47066 4.14958 4.65729 4.05641 4.85863 4.02404C5.05998 3.99166 5.26641 4.02161 5.45025 4.10988L19.4502 11.1099C19.614 11.1938 19.7515 11.3213 19.8475 11.4783C19.9435 11.6354 19.9943 11.8158 19.9943 11.9999C19.9943 12.1839 19.9435 12.3644 19.8475 12.5214C19.7515 12.6785 19.614 12.806 19.4502 12.8899Z"
                  fill="black"
                />
              </svg>
            </span>
          </button>
        </form>
        <div className="contact-right">
          <h3>
            Información <span className="highlight">de contacto</span>
          </h3>
          <div className="contact-info">
            <div className="info">
              <div>
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M20 10C20 14.993 14.461 20.193 12.601 21.799C12.4277 21.9293 12.2168 21.9998 12 21.9998C11.7832 21.9998 11.5723 21.9293 11.399 21.799C9.539 20.193 4 14.993 4 10C4 7.87827 4.84285 5.84344 6.34315 4.34315C7.84344 2.84285 9.87827 2 12 2C14.1217 2 16.1566 2.84285 17.6569 4.34315C19.1571 5.84344 20 7.87827 20 10Z"
                    stroke="#F19200"
                    strokeWidth="2"
                    strokeLinecap="round"
                    strokeLinejoin="round"
                  />
                  <path
                    d="M12 13C13.6569 13 15 11.6569 15 10C15 8.34315 13.6569 7 12 7C10.3431 7 9 8.34315 9 10C9 11.6569 10.3431 13 12 13Z"
                    stroke="#F19200"
                    strokeWidth="2"
                    strokeLinecap="round"
                    strokeLinejoin="round"
                  />
                </svg>
              </div>
              <Link
                target="_blank"
                href="https://www.google.com/maps/place/OFTTARQ+CORDERO/@-2.8985713,-79.0042523,17z/data=!3m1!4b1!4m6!3m5!1s0x91cd1926262bfbdb:0x78d51c067c80cd87!8m2!3d-2.8985713!4d-79.0042523!16s%2Fg%2F11tdxp1xxk!17m2!4m1!1e3!18m1!1e1?entry=ttu&g_ep=EgoyMDI1MTAyNy4wIKXMDSoASAFQAw%3D%3D"
              >
                Calle Luis Cordero 7-53
                <br />
                Planta Alta (frente al Teatro Casa de la Cultura)
              </Link>
            </div>
            <div className="info">
              <div>
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M20 10C20 14.993 14.461 20.193 12.601 21.799C12.4277 21.9293 12.2168 21.9998 12 21.9998C11.7832 21.9998 11.5723 21.9293 11.399 21.799C9.539 20.193 4 14.993 4 10C4 7.87827 4.84285 5.84344 6.34315 4.34315C7.84344 2.84285 9.87827 2 12 2C14.1217 2 16.1566 2.84285 17.6569 4.34315C19.1571 5.84344 20 7.87827 20 10Z"
                    stroke="#F19200"
                    strokeWidth="2"
                    strokeLinecap="round"
                    strokeLinejoin="round"
                  />
                  <path
                    d="M12 13C13.6569 13 15 11.6569 15 10C15 8.34315 13.6569 7 12 7C10.3431 7 9 8.34315 9 10C9 11.6569 10.3431 13 12 13Z"
                    stroke="#F19200"
                    strokeWidth="2"
                    strokeLinecap="round"
                    strokeLinejoin="round"
                  />
                </svg>
              </div>
              <Link
                target="_blank"
                href="https://www.google.com/maps/place/OFTTARQ+CORDERO%2Fsucursal/@-2.8612842,-78.964333,17z/data=!3m1!4b1!4m6!3m5!1s0x91cd17000be26b61:0x62a4a81337e4d719!8m2!3d-2.8612842!4d-78.964333!16s%2Fg%2F11ylpl_66f!17m2!4m1!1e3!18m1!1e1?entry=ttu&g_ep=EgoyMDI1MTAyNy4wIKXMDSoASAFQAw%3D%3D"
              >
                Centro de Ricaurte
                <br />
                Calle Daniel Durán a 1 cuadra del Mercado de Ricaurte
              </Link>
            </div>
            <div className="info">
              <div>
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 20 20"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M15.8737 4.09106C15.1096 3.31948 14.1996 2.7077 13.1966 2.29136C12.1937 1.87503 11.1179 1.66246 10.032 1.66606C5.48203 1.66606 1.7737 5.37439 1.7737 9.92439C1.7737 11.3827 2.15703 12.7994 2.8737 14.0494L1.70703 18.3327L6.08203 17.1827C7.29036 17.8411 8.6487 18.1911 10.032 18.1911C14.582 18.1911 18.2904 14.4827 18.2904 9.93273C18.2904 7.72439 17.432 5.64939 15.8737 4.09106ZM10.032 16.7911C8.7987 16.7911 7.59036 16.4577 6.53203 15.8327L6.28203 15.6827L3.68203 16.3661L4.3737 13.8327L4.20703 13.5744C3.52165 12.4803 3.1578 11.2155 3.15703 9.92439C3.15703 6.14106 6.24036 3.05773 10.0237 3.05773C11.857 3.05773 13.582 3.77439 14.8737 5.07439C15.5134 5.71095 16.0203 6.46818 16.3651 7.30217C16.7098 8.13616 16.8855 9.0303 16.882 9.93273C16.8987 13.7161 13.8154 16.7911 10.032 16.7911ZM13.7987 11.6577C13.5904 11.5577 12.5737 11.0577 12.3904 10.9827C12.1987 10.9161 12.0654 10.8827 11.9237 11.0827C11.782 11.2911 11.3904 11.7577 11.2737 11.8911C11.157 12.0327 11.032 12.0494 10.8237 11.9411C10.6154 11.8411 9.9487 11.6161 9.16536 10.9161C8.5487 10.3661 8.14036 9.69106 8.01536 9.48273C7.8987 9.27439 7.9987 9.16606 8.10703 9.05773C8.1987 8.96606 8.31536 8.81606 8.41536 8.69939C8.51536 8.58273 8.55703 8.49106 8.6237 8.35773C8.69036 8.21606 8.65703 8.09939 8.60703 7.99939C8.55703 7.89939 8.14036 6.88273 7.9737 6.46606C7.80703 6.06606 7.63203 6.11606 7.50703 6.10773H7.10703C6.96536 6.10773 6.7487 6.15773 6.55703 6.36606C6.3737 6.57439 5.84036 7.07439 5.84036 8.09106C5.84036 9.10773 6.58203 10.0911 6.68203 10.2244C6.78203 10.3661 8.14036 12.4494 10.207 13.3411C10.6987 13.5577 11.082 13.6827 11.382 13.7744C11.8737 13.9327 12.3237 13.9077 12.682 13.8577C13.082 13.7994 13.907 13.3577 14.0737 12.8744C14.2487 12.3911 14.2487 11.9827 14.1904 11.8911C14.132 11.7994 14.007 11.7577 13.7987 11.6577Z"
                    fill="#F19200"
                  />
                </svg>
              </div>
              <Link target="_blank" href="tel:+5930993157621">
                099 489 6810
              </Link>
            </div>
            <div className="info">
              <div>
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M22 7L13.009 12.727C12.7039 12.9042 12.3573 12.9976 12.0045 12.9976C11.6517 12.9976 11.3051 12.9042 11 12.727L2 7"
                    stroke="#F19200"
                    strokeWidth="2"
                    strokeLinecap="round"
                    strokeLinejoin="round"
                  />
                  <path
                    d="M20 4H4C2.89543 4 2 4.89543 2 6V18C2 19.1046 2.89543 20 4 20H20C21.1046 20 22 19.1046 22 18V6C22 4.89543 21.1046 4 20 4Z"
                    stroke="#F19200"
                    strokeWidth="2"
                    strokeLinecap="round"
                    strokeLinejoin="round"
                  />
                </svg>
              </div>
              <Link
                target="_blank"
                href="mailto:ofttarqcordero@hotmail.com,alexcordero67@hotmail.com"
              >
                alexcordero67@hotmail.com
                <br />
                ofttarqcordero@hotmail.com
              </Link>
            </div>
          </div>
          <div className="social">
            <Link href="https://www.facebook.com/ofttarq">
              <svg
                width="32"
                height="32"
                viewBox="0 0 32 32"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M27.867 2.66675H4.13366C3.74467 2.66675 3.37162 2.82127 3.09657 3.09632C2.82152 3.37138 2.66699 3.74443 2.66699 4.13341V27.8667C2.66699 28.2557 2.82152 28.6288 3.09657 28.9038C3.37162 29.1789 3.74467 29.3334 4.13366 29.3334H16.907V19.0001H13.4403V15.0001H16.907V12.0001C16.8352 11.2958 16.9183 10.5842 17.1506 9.91546C17.3829 9.24668 17.7587 8.63681 18.2516 8.12863C18.7445 7.62045 19.3427 7.22627 20.0041 6.97373C20.6655 6.72119 21.3741 6.61642 22.0803 6.66675C23.1181 6.65958 24.1554 6.71301 25.187 6.82675V10.4267H23.067C21.387 10.4267 21.067 11.2267 21.067 12.3867V14.9601H25.067L24.547 18.9601H21.067V29.3334H27.867C28.0596 29.3334 28.2503 29.2955 28.4283 29.2218C28.6062 29.1481 28.7679 29.04 28.9041 28.9038C29.0403 28.7676 29.1483 28.606 29.222 28.428C29.2957 28.2501 29.3337 28.0594 29.3337 27.8667V4.13341C29.3337 3.94081 29.2957 3.75009 29.222 3.57215C29.1483 3.3942 29.0403 3.23252 28.9041 3.09632C28.7679 2.96013 28.6062 2.8521 28.4283 2.77839C28.2503 2.70468 28.0596 2.66675 27.867 2.66675Z"
                  fill="#F19200"
                />
              </svg>
            </Link>
            <Link href="https://www.instagram.com/ofttarq_cordero/">
              <svg
                width="38"
                height="38"
                viewBox="0 0 38 38"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M20.6271 3.16675C22.4083 3.1715 23.3124 3.181 24.093 3.20316L24.4001 3.21425C24.7548 3.22691 25.1047 3.24275 25.5275 3.26175C27.2121 3.34091 28.3616 3.60691 29.3702 3.998C30.4152 4.40016 31.2956 4.94483 32.1759 5.82358C32.9813 6.61482 33.6044 7.57233 34.0015 8.62925C34.3926 9.63783 34.6586 10.7873 34.7377 12.4736C34.7567 12.8947 34.7726 13.2447 34.7852 13.6009L34.7947 13.9081C34.8185 14.6871 34.828 15.5912 34.8311 17.3724L34.8327 18.5536V20.6277C34.8366 21.7826 34.8244 22.9375 34.7963 24.0921L34.7868 24.3992C34.7741 24.7555 34.7583 25.1054 34.7393 25.5266C34.6601 27.2128 34.391 28.3607 34.0015 29.3709C33.6044 30.4278 32.9813 31.3853 32.1759 32.1766C31.3847 32.982 30.4271 33.605 29.3702 34.0022C28.3616 34.3932 27.2121 34.6593 25.5275 34.7384L24.4001 34.7859L24.093 34.7954C23.3124 34.8176 22.4083 34.8287 20.6271 34.8318L19.4459 34.8334H17.3733C16.2179 34.8375 15.0625 34.8253 13.9074 34.797L13.6002 34.7875C13.2244 34.7733 12.8486 34.7569 12.4729 34.7384C10.7882 34.6593 9.63873 34.3932 8.62856 34.0022C7.57221 33.6048 6.61526 32.9818 5.82448 32.1766C5.01847 31.3855 4.3949 30.428 3.99731 29.3709C3.60623 28.3623 3.34023 27.2128 3.26106 25.5266L3.21356 24.3992L3.20565 24.0921C3.17646 22.9375 3.16326 21.7827 3.16606 20.6277V17.3724C3.16168 16.2175 3.17329 15.0626 3.2009 13.9081L3.21198 13.6009C3.22465 13.2447 3.24048 12.8947 3.25948 12.4736C3.33865 10.7873 3.60464 9.63941 3.99573 8.62925C4.39424 7.5719 5.01892 6.61436 5.82606 5.82358C6.61639 5.01853 7.57278 4.39553 8.62856 3.998C9.63873 3.60691 10.7866 3.34091 12.4729 3.26175C12.8941 3.24275 13.2456 3.22691 13.6002 3.21425L13.9074 3.20475C15.062 3.17662 16.2168 3.16448 17.3717 3.16833L20.6271 3.16675ZM18.9994 11.0834C16.8998 11.0834 14.8861 11.9175 13.4015 13.4022C11.9168 14.8868 11.0827 16.9005 11.0827 19.0001C11.0827 21.0997 11.9168 23.1133 13.4015 24.598C14.8861 26.0827 16.8998 26.9167 18.9994 26.9167C21.099 26.9167 23.1127 26.0827 24.5973 24.598C26.082 23.1133 26.9161 21.0997 26.9161 19.0001C26.9161 16.9005 26.082 14.8868 24.5973 13.4022C23.1127 11.9175 21.099 11.0834 18.9994 11.0834ZM18.9994 14.2501C19.6232 14.25 20.2409 14.3727 20.8172 14.6114C21.3935 14.85 21.9172 15.1998 22.3584 15.6408C22.7995 16.0818 23.1495 16.6053 23.3883 17.1816C23.6271 17.7579 23.7501 18.3755 23.7502 18.9993C23.7503 19.6231 23.6275 20.2408 23.3889 20.8171C23.1503 21.3934 22.8005 21.9171 22.3595 22.3583C21.9185 22.7994 21.3949 23.1494 20.8187 23.3882C20.2424 23.627 19.6248 23.75 19.001 23.7501C17.7412 23.7501 16.533 23.2496 15.6422 22.3588C14.7514 21.468 14.251 20.2599 14.251 19.0001C14.251 17.7403 14.7514 16.5321 15.6422 15.6413C16.533 14.7505 17.7412 14.2501 19.001 14.2501M27.3135 8.70842C26.7886 8.70842 26.2852 8.91693 25.914 9.2881C25.5428 9.65927 25.3343 10.1627 25.3343 10.6876C25.3343 11.2125 25.5428 11.7159 25.914 12.0871C26.2852 12.4582 26.7886 12.6667 27.3135 12.6667C27.8384 12.6667 28.3418 12.4582 28.713 12.0871C29.0841 11.7159 29.2926 11.2125 29.2926 10.6876C29.2926 10.1627 29.0841 9.65927 28.713 9.2881C28.3418 8.91693 27.8384 8.70842 27.3135 8.70842Z"
                  fill="#F19200"
                />
              </svg>
            </Link>
            <Link href="https://www.tiktok.com/@alex_cordero67">
              <svg
                width="40"
                height="40"
                viewBox="0 0 40 40"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M26.6667 36.25C29.2083 36.25 31.6459 35.2403 33.4431 33.4431C35.2403 31.6459 36.25 29.2083 36.25 26.6667V13.3333C36.25 10.7917 35.2403 8.35412 33.4431 6.55689C31.6459 4.75967 29.2083 3.75 26.6667 3.75H13.3333C10.7917 3.75 8.35412 4.75967 6.55689 6.55689C4.75967 8.35412 3.75 10.7917 3.75 13.3333V26.6667C3.75 29.2083 4.75967 31.6459 6.55689 33.4431C8.35412 35.2403 10.7917 36.25 13.3333 36.25H26.6667ZM22.8517 9.605C22.7574 9.32407 22.5663 9.08578 22.3126 8.93265C22.0589 8.77952 21.759 8.72151 21.4665 8.76896C21.174 8.81641 20.9078 8.96624 20.7156 9.19172C20.5233 9.4172 20.4173 9.70366 20.4167 10V25C20.4167 25.7417 20.1967 26.4667 19.7847 27.0834C19.3726 27.7001 18.787 28.1807 18.1017 28.4645C17.4165 28.7484 16.6625 28.8226 15.9351 28.6779C15.2076 28.5332 14.5395 28.1761 14.015 27.6516C13.4906 27.1272 13.1334 26.459 12.9887 25.7316C12.844 25.0042 12.9183 24.2502 13.2021 23.5649C13.4859 22.8797 13.9666 22.294 14.5833 21.882C15.2 21.4699 15.925 21.25 16.6667 21.25C16.9982 21.25 17.3161 21.1183 17.5505 20.8839C17.785 20.6495 17.9167 20.3315 17.9167 20C17.9167 19.6685 17.785 19.3505 17.5505 19.1161C17.3161 18.8817 16.9982 18.75 16.6667 18.75C15.4305 18.75 14.2222 19.1166 13.1944 19.8033C12.1665 20.4901 11.3655 21.4662 10.8924 22.6082C10.4194 23.7503 10.2956 25.0069 10.5368 26.2193C10.7779 27.4317 11.3732 28.5453 12.2472 29.4194C13.1213 30.2935 14.235 30.8887 15.4474 31.1299C16.6597 31.3711 17.9164 31.2473 19.0584 30.7742C20.2005 30.3012 21.1766 29.5001 21.8634 28.4723C22.5501 27.4445 22.9167 26.2361 22.9167 25V14.0967C24.195 15.2833 25.995 16.25 28.3333 16.25C28.6649 16.25 28.9828 16.1183 29.2172 15.8839C29.4516 15.6495 29.5833 15.3315 29.5833 15C29.5833 14.6685 29.4516 14.3505 29.2172 14.1161C28.9828 13.8817 28.6649 13.75 28.3333 13.75C26.7133 13.75 25.4817 13.0833 24.5683 12.2183C23.635 11.3317 23.0717 10.2633 22.8517 9.605Z"
                  fill="#F19200"
                />
              </svg>
            </Link>
          </div>
          <div className="bottom">
            <h4>
              Horario <span className="highlight">Comercial</span>
            </h4>
            <p>Domingo a viernes: 8:30 AM - 5:30 PM</p>
            <p>Sábado: Cerrado</p>
            <p>Domingo: Cerrado</p>
          </div>
        </div>
      </div>
    </section>
  );
};

export default Contact;
